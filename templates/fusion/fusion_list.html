{% extends "site_base.html" %}

{% load convert_tags %}
{% load i18n %}
{% load ifsetting_tag %}

{% block head_title %}{% trans "Fusion List" %}{% endblock %}

{% block subnav_base %}{% endblock %}

{% block body_class %}fusions{% endblock %}

{% block body %}
{% include "fusion/fusion_tag_cloud.html" %}
<form>
Keyword: <input name="keyword" value="{{ request.GET.keyword }}" />
{% if user.is_authenticated %}
<input type="checkbox" name="justmine" {% if request.GET.justmine %}checked="checked"{% endif %}> My fusions only
{% endif %}
<input type="submit" />
</form>
<table id="fusionlist" class="listtable">
{% for fusion in fusion_list %}
    {% cycle '<tr>' '' '' '' '' %}
    <td>
			{% if fusion.thenfile and fusion.nowfile %}
				<a href="{% url fusion_detail fusion.id %}{{ fusion.description|slugify }}">{% thumbnail fusion.thenfile '200x200' %}</a>
				<a href="{% url fusion_detail fusion.id %}{{ fusion.description|slugify }}">{% thumbnail fusion.nowfile '200x200' %}</a>
			{% else %}
				<a href="{% url fusion_detail fusion.id %}{{ fusion.description|slugify }}">{% thumbnail fusion.then.imageurl '200x200' %}</a>
				<a href="{% url fusion_detail fusion.id %}{{ fusion.description|slugify }}">{% thumbnail fusion.now.imageurl '200x200' %}</a>
			{% endif %}
	</a>
    <br/>
    <a href="{% url fusion_detail fusion.id %}{{ fusion.description|slugify }}">{{ fusion.description }}</a>
{% if user.is_superuser %}
  <a href="/admin/fusion/fusion/{{ fusion.id }}/" target="_blank">admin</a> 
  <a href="/admin/fusion/fusion/{{ fusion.id }}/delete/" target="_blank">delete</a>
{% endif %}
    </td>
    {% if forloop.last %}</tr>{% else %}{% cycle '' '' '' '' '</tr>' %}{% endif %}
{% endfor %}
</table>
<div class="pagination">
    <span class="step-links">
        <a href="?page=1">first</a>
        {% if page_obj.has_previous %}
            <a href="?page={{ page_obj.previous_page_number }}">previous</a>
        {% endif %}

        <span class="current">
            Page {{ page_obj.number }} of {{ paginator.num_pages }}
        </span>

        {% if page_obj.has_next %}
            <a href="?page={{ page_obj.next_page_number }}">next</a>
        {% endif %}
        <a href="?page=last">last</a>
    </span>
</div>
</div>
{% endblock %}
